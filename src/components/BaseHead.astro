---
// Import the globals.css file here so that it is included on
// all pages through the use of the <BaseHead /> component.
import "../styles/globals.css";

// Import utilities from astro:content
import { SEO_KEYWORDS, SCHEMA_ORG, SOCIAL_MEDIA } from "../consts";

export interface Props {
  title: string;
  description: string;
  image?: string;
  canonicalUrl?: string;
  imageAlt?: string;
  type?: string;
}

const {
  title,
  description,
  image = "/images/cabinet-avocats-cugnaux.jpg",
  canonicalUrl = Astro.url.href,
  imageAlt = "Cabinet d'avocats Cugnaux - Image représentative",
  type = "website",
} = Astro.props;

// Construction des URLs absolues
const siteUrl = Astro.site || "https://www.avocats-diane.fr";
const imageUrl = new URL(image, siteUrl).toString();

// Génère l'année côté serveur uniquement pour éviter les problèmes d'hydratation
const currentYear = new Intl.DateTimeFormat("fr-FR", {
  year: "numeric",
}).format(new Date());
---

<!-- Global Metadata -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="generator" content={Astro.generator} />

<!-- Préchargement des ressources critiques -->
<link rel="preload" href="/favicon.svg" as="image" type="image/svg+xml" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

<!-- Sitemap -->
<link rel="sitemap" href="/sitemap-index.xml" />

<!-- Canonical URL -->
<link rel="canonical" href={canonicalUrl} />

<!-- Primary Meta Tags -->
<title>{title}</title>
<meta name="title" content={title} />
<meta name="description" content={description} />
<meta name="keywords" content={SEO_KEYWORDS.join(", ")} />
<meta name="author" content="Cabinet d'avocats Cugnaux" />
<meta name="copyright" content="© {currentYear} Cabinet d'avocats Cugnaux" />

<!-- Open Graph / Facebook -->
<meta property="og:site_name" content="Cabinet d'avocats Cugnaux" />
<meta property="og:type" content={type} />
<meta property="og:url" content={canonicalUrl} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:image" content={imageUrl} />
<meta property="og:image:alt" content={imageAlt} />
<meta property="og:locale" content="fr_FR" />

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:url" content={canonicalUrl} />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={imageUrl} />
<meta name="twitter:image:alt" content={imageAlt} />

<!-- Données structurées Schema.org -->
<script type="application/ld+json" set:html={JSON.stringify(SCHEMA_ORG)} />

<!-- Données sociales pour Organisation -->
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "SCP Crouzatier Yves / Pobéda-Thomas Florence",
    "url": "https://www.avocats-diane.fr",
    "logo": "https://www.avocats-diane.fr/favicon.svg",
    "sameAs": [
      "{SOCIAL_MEDIA.facebook}",
      "{SOCIAL_MEDIA.linkedin}",
      "{SOCIAL_MEDIA.twitter}",
      "{SOCIAL_MEDIA.instagram}"
    ]
  }
</script>

<!-- SEO -->
<meta
  name="robots"
  content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"
/>
<meta name="googlebot" content="index, follow" />
<meta name="rating" content="general" />
<meta name="geo.region" content="FR-31" />
<meta name="geo.placename" content="Cugnaux" />
<meta name="geo.position" content="43.5581832;1.3627580" />
<meta name="ICBM" content="43.5581832, 1.3627580" />

<!-- Langue -->
<link rel="alternate" hreflang="fr" href={canonicalUrl} />
<meta name="language" content="French" />
<meta property="og:locale:alternate" content="fr_FR" />

<!-- Favicons -->
<link rel="icon" href="/favicon.ico" sizes="any" />
<link rel="icon" href="/favicon.svg" type="image/svg+xml" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
<link rel="manifest" href="/site.webmanifest" />
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#8B0000" />
<meta name="msapplication-TileColor" content="#8B0000" />
<meta name="msapplication-config" content="/browserconfig.xml" />
<meta
  name="theme-color"
  content="#8B0000"
  media="(prefers-color-scheme: light)"
/>
<meta
  name="theme-color"
  content="#8B0000"
  media="(prefers-color-scheme: dark)"
/>

<!-- Performance & Security -->
<meta
  http-equiv="Content-Security-Policy"
  content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://*.googleapis.com https://*.gstatic.com https://*.google.com https://maps.google.com https://www.google.com https://www.gstatic.com https://recaptcha.net https://challenges.cloudflare.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://*.googleapis.com; font-src 'self' data: https://fonts.gstatic.com https://*.gstatic.com; img-src 'self' data: https://www.avocats-diane.fr https://*.googleapis.com https://*.gstatic.com https://*.google.com; connect-src 'self' https://*.googleapis.com https://*.google.com https://*.gstatic.com https://recaptcha.net; frame-src 'self' https://www.google.com https://*.google.com https://recaptcha.net https://challenges.cloudflare.com;"
/>
<meta http-equiv="X-Content-Type-Options" content="nosniff" />
<meta http-equiv="X-Frame-Options" content="SAMEORIGIN" />
<meta name="referrer" content="strict-origin-when-cross-origin" />
